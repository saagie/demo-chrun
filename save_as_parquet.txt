                               
			Save Churn_Modelling.csv as parquet in HDFS

1.  Create a database in Impala

CREATE DATABASE IF NOT EXISTS  open_data;

2. Store Churn_Modelling.csv as Impala table 

DROP TABLE IF EXISTS open_data.bank;

CREATE EXTERNAL TABLE open_data.bank (
RowNumber int,
CustomerId int,
Surname string,
CreditScore int,
Geography string,
Gender string,
Age int,
Tenure int,
Balance float,
NumOfProducts int,
HasCrCard int,
IsActiveMember int,
EstimatedSalary float,
Exited int )
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
LOCATION  '/OpenData/kaggle'  
tblproperties ("skip.header.line.count"="1");

3.  Save Impala table as a Parquet

DROP TABLE IF EXISTS open_data.clean_bank;

CREATE EXTERNAL TABLE open_data.clean_bank (RowNumber int,
CustomerId int,
Surname string,
CreditScore int,
Geography string,
Gender string,
Age int,
Tenure int,
Balance float,
NumOfProducts int,
HasCrCard int,
IsActiveMember int,
EstimatedSalary float,
Exited int )
stored as PARQUET
LOCATION '/user/chandima.pondapelage/Bank/clean_bank_data';

INSERT OVERWRITE TABLE open_data.clean_bank                                                                                    
SELECT
RowNumber,
CustomerId,
Surname,
CreditScore,
Geography,
Gender,
Age,
Tenure,
Balance,
NumOfProducts,
HasCrCard,
IsActiveMember,
EstimatedSalary,
Exited
FROM open_data.bank ;

SELECT * FROM open_data.clean_bank;
